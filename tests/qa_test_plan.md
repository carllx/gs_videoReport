# QA测试方案 - YouTube视频分析功能

## 测试目标
验证gs_videoReport系统的视频分析、中文转录和教案生成功能的完整性和可靠性。

## 测试范围

### 1. 功能测试
- [x] 基础CLI功能验证
- [ ] YouTube视频访问权限测试
- [ ] 中文转录模板功能测试
- [ ] 文件输出和格式验证测试
- [ ] 错误处理和边界条件测试

### 2. 性能测试
- [ ] 不同长度视频处理时间
- [ ] 内存使用情况监控
- [ ] API调用效率测试

### 3. 安全测试
- [ ] API密钥安全性验证
- [ ] 私有视频访问权限控制
- [ ] 文件输出权限验证

## 测试用例设计

### TC001: 公共YouTube视频访问测试
**测试目标**: 验证系统能否正确识别和处理公共YouTube视频

**测试数据**:
- URL: https://www.youtube.com/watch?v=7r7ZDugy3EE
- 预期: 视频可访问，可获取基本信息

**测试步骤**:
1. 使用yt-dlp验证视频可下载性
2. 下载视频到本地进行分析
3. 验证系统能正确处理视频文件

**预期结果**:
- [ ] 视频URL返回200状态码
- [ ] 视频可以成功下载
- [ ] 系统能读取视频元数据
- [ ] 分析过程无错误

**实际结果**: _待测试_

---

### TC002: 私有YouTube视频访问测试
**测试目标**: 验证系统对私有视频的错误处理机制

**测试数据**:
- URL: https://www.youtube.com/watch?v=EXmz9O1xQbM
- 预期: 视频不可访问，系统应优雅处理错误

**测试步骤**:
1. 尝试访问私有视频URL
2. 验证系统错误处理机制
3. 检查错误信息的用户友好性

**预期结果**:
- [ ] 视频URL返回403或404状态码
- [ ] 系统显示清晰的错误信息
- [ ] 不会导致程序崩溃
- [ ] 提供解决方案建议

**实际结果**: _待测试_

---

### TC003: 中文转录模板功能测试
**测试目标**: 验证自定义中文转录模板的完整功能

**测试数据**:
- 模板名称: chinese_transcript
- 测试视频: 公共中文教育视频

**测试步骤**:
1. 确认模板在系统中可用
2. 使用模板分析测试视频
3. 验证输出格式符合预期

**预期结果**:
- [ ] 模板在`list-templates`中显示
- [ ] 生成简体中文逐字稿
- [ ] 包含精确时间戳
- [ ] 标识讲者名字
- [ ] 包含第一人称重点整理
- [ ] 术语和人物使用英语显示
- [ ] 图像信息补充(如适用)

**输出格式验证**:
```yaml
预期结构:
- YAML frontmatter包含视频元数据
- # 视频标题 - 中文逐字稿分析
- ## 基本信息
- ## 逐字稿内容 (带时间戳和讲者)
- ## 重点整理（第一人称视角）
- ## 关键术语和人物
- ## 图像补充信息
```

**实际结果**: _待测试_

---

### TC004: 文件输出格式验证测试
**测试目标**: 确保生成的Markdown文件符合Obsidian兼容格式

**测试步骤**:
1. 分析测试视频生成教案文件
2. 检查YAML frontmatter格式
3. 验证Markdown语法正确性
4. 测试时间戳链接可点击性

**预期结果**:
- [ ] YAML frontmatter格式正确
- [ ] 包含必需的metadata字段
- [ ] Markdown语法无错误
- [ ] 时间戳链接格式正确
- [ ] 文件编码为UTF-8
- [ ] 文件名包含时间戳和视频标题

**实际结果**: _待测试_

---

### TC005: 错误处理和边界条件测试
**测试目标**: 验证系统在各种异常情况下的稳定性

**测试场景**:
1. **无效API密钥**
   - 输入: 错误的Gemini API密钥
   - 预期: 显示清晰的认证错误信息

2. **超大文件处理**
   - 输入: 超过配置限制的大视频文件
   - 预期: 显示文件大小限制警告

3. **网络连接问题**
   - 输入: 断网状态下运行分析
   - 预期: 显示网络连接错误

4. **无效视频格式**
   - 输入: 非支持格式的文件
   - 预期: 显示格式不支持错误

**预期结果**: 所有错误场景都有友好的错误提示

---

### TC006: 性能基准测试
**测试目标**: 建立系统性能基准线

**测试数据**:
- 短视频 (< 5分钟)
- 中等视频 (5-20分钟)  
- 长视频 (20-60分钟)

**测量指标**:
- [ ] 处理时间
- [ ] 内存峰值使用
- [ ] API调用次数
- [ ] 生成文件大小

**性能目标**:
- 短视频: < 2分钟处理时间
- 中等视频: < 10分钟处理时间
- 长视频: < 30分钟处理时间

**实际结果**: _待测试_

---

## 测试环境配置

### 前置条件
1. Python 3.13+ 环境
2. 安装所有项目依赖
3. 有效的Google Gemini API密钥
4. yt-dlp工具安装
5. 充足的磁盘空间 (至少2GB用于测试视频)

### 配置文件设置
使用 `test_config.yaml` 进行测试，确保包含:
- 有效的API密钥
- 详细日志输出 (`verbose: true`)
- 合适的超时设置
- 测试输出目录配置

## 数据收集和验证

### 自动化验证脚本
使用提供的 `test_videos.py` 脚本进行自动化测试。

### 手动验证检查点
1. **视频下载验证**:
   ```bash
   ls -la test_videos/
   file test_videos/*.mp4
   ```

2. **模板可用性验证**:
   ```bash
   python -m src.gs_video_report.cli list-templates
   ```

3. **输出文件验证**:
   ```bash
   ls -la test_output/
   head -n 20 test_output/*.md
   ```

## 测试报告格式

每个测试用例完成后，记录:
- ✅/❌ 测试状态
- 实际输出结果
- 与预期的差异
- 发现的问题和建议
- 性能数据 (如适用)

## 问题追踪

发现的问题将按优先级分类:
- 🚨 **严重**: 导致功能完全无法使用
- ⚠️ **重要**: 影响核心功能但有替代方案
- 💡 **改进**: 用户体验优化建议

## 验收标准

测试通过的最低标准:
- [ ] 所有核心功能测试用例通过 (TC001-TC004)
- [ ] 错误处理机制正常工作 (TC005)
- [ ] 性能在可接受范围内 (TC006)
- [ ] 输出格式完全符合规范
- [ ] 无严重等级的缺陷
